# SAS for Microsoft 365 Demo Steps

Bringing together SAS Viya and Microsoft 365 allows you to take
advantage of the strengths of both worlds. You can use SAS Viya to
prepare your data and create deep analytical insights, then explore and
share results in familiar Microsoft applications including Excel, Word,
PowerPoint, and Outlook.

------------------------------------------------------------------------

# Table of Contents
Add links to sections here

# Notes for me

-   Add a slide explaining who has access to SAS for Microsoft 365.
-   Provide installation/loading instructions.
-   Consider including a QR code linking to documentation or workshop
    resources.
-   Add SVG icons and screenshots where helpful.

------------------------------------------------------------------------

# Part 1: Examine the Warranty Analysis Report in SAS Visual Analytics

1.  Open Google Chrome and click **SASLanding** from the bookmarks bar.
<img width="765" height="122" alt="Image" src="https://github.com/user-attachments/assets/f08d069a-1310-4759-a9e4-de4fce217c64" />

2.  The login page should be pre-populated. If not, use the following credentials to log in:

    **Username:** student
    
    **Password:** Metadata0
<img width="425" height="336" alt="Image" src="https://github.com/user-attachments/assets/975a6eb3-29aa-4526-b3cf-d51140e9e531" />

3. Click **Sign in**. If asked to opt in to all your assumable groups, select **Yes**.
<img width="420" height="380" alt="Image" src="https://github.com/user-attachments/assets/0e9a2996-3d78-425b-99b7-f4da270c81fa" />

4.  Open **SAS Visual Analytics** from the Applications menu by
    selecting **Explore and Visualize**.

<img height="400" alt="Image" src="https://github.com/user-attachments/assets/fc77248e-361a-4904-b4c4-7e1868357fd3" />

<img height="600" alt="Image" src="https://github.com/user-attachments/assets/61db7fe1-eec0-45d9-9a3d-0328fcc02a31" />

5.  Navigate to:

    **SAS Content** \> **Products** \> **SAS Visual Analytics** \> **Samples**
<img width="1559" height="397" alt="Image" src="https://github.com/user-attachments/assets/a587f280-0e70-4dbb-8fbb-0cd19d164710" />

6.  Double-click **Warranty Analysis** to open the report. This report has multiple pages and report objects that can be viewed and shared in Microsoft applications.
<img width="1917" height="946" alt="Image" src="https://github.com/user-attachments/assets/adf1b460-7433-49b8-87b7-edee8e4f7f81" />

7.  Select **Opened Reports** in the upper-right corner, then click **Close all reports**.
<img width="396" height="225" alt="Image" src="https://github.com/user-attachments/assets/103c04f5-45a2-46c9-b103-ebcf27c43a10" />

8.  Right-click **Warranty Analysis** and select **Add to Favorites**.
<img width="1555" height="669" alt="Image" src="https://github.com/user-attachments/assets/f6001f40-1789-41ef-9d08-df61b5068f61" />

# Part 2: Access the SAS Panel in Excel

9. Close out of Google Chrome, open the Microsoft Excel desktop application, and create a new workbook. Maximize the workbook so it fills the screen. **Note:** In this demonstration we use the Microsoft desktop applications, however SAS for Microsoft 365 works with the web applications as well.

10. Select **SAS Viya** in the ribbon along the top of the window.

11.	From the SAS Viya tab, select **Home**. A panel opens on the right, prompting you to login to SAS Viya. In the SAS-provided virtual lab, enter **Student** as the User ID and **Metadata0** as the password. If asked to opt in to all your assumable groups, select **Yes**. Once you are connected, the panel provides access to all reports, data, and programs in the SAS Viya environment.

<img width="1922" height="1032" alt="Image" src="https://github.com/user-attachments/assets/34159138-15d2-4c92-8679-def1c816f28d" />


12.	On the **Home** tab, select **Favorites** from the drop-down list. You can quickly access open, recent, and favorite SAS reports and data.

13.	Click **More options** to view additional actions, such as the ability to upload data to SAS Viya. (Think more on this section, maybe point out list view, upload data here then later do an example changing preferences.)

<img width="730" height="410" alt="Image" src="https://github.com/user-attachments/assets/98e45e35-1e2b-48d6-bc46-cd551cff1cc6" />

# Part 3: Inserting Report Content

14.	From the SAS pane, select the **Reports** tab. Expand **My Favorites** and double-click the **Warranty Analysis** report.
 <img height = "550" alt="Image" src="https://github.com/user-attachments/assets/be671d6e-22e0-4e68-9ecf-fa95987b7f55" />
 

15.	Drag the left border of the SAS pane to enlarge the report preview. In the **Results** tab, you can view the different report pages and interact with the report objects, just like in Visual Analytics.  For example, verify the **Cost Overview** report page is active. Click **2016** to filter the data and update the report objects.
<img height = "550" alt="Image" src="https://github.com/user-attachments/assets/2436095a-33fd-45c0-9c6c-e417603d73d1" />


16.	Hover over the bar chart and click **Maximize**. Alternatively, you can right-click the chart and select **Maximize view**.
<img height = "200" alt="Image" src="https://github.com/user-attachments/assets/d460a177-dbfb-4773-98f0-dbb1c2cf6f39" />

17.	Ensure the top left cell of the Excel worksheet is selected. Select either **Object menu** or right-click the chart and select **Insert in document**. An image of the bar chart is added to the Excel worksheet, along with an indicator of the filter selection.
<img height = "550" alt="Image" src="https://github.com/user-attachments/assets/e800fc35-4e56-4087-bf77-0ffb4e879f9a" />

<img width="1920" height="808" alt="Image" src="https://github.com/user-attachments/assets/90eb162a-643c-4795-8940-e0418c4009f8" />


18.	Select the graph image in the worksheet. From the SAS Viya tab in the ribbon, click **Selected Object** to update the object, remove it from the document, find it in the SAS pane, or unlink it from SAS.
<img  height = "550" alt="Image" src="https://github.com/user-attachments/assets/9dc79177-7481-42f2-bf3c-1c1209901aa1" />

19.	Resize the graph to make it wider, then click **Selected Object > Update** or **Update All** from the SAS Viya tab to update the image based on the new dimensions. Notice the x axis tick labels no longer overlap.
<img  height = "550" alt="Image" src="https://github.com/user-attachments/assets/9764ca81-73d2-462a-94f6-0cfb596a8b32" />

20.	In the report preview in the SAS pane, select **2015** in the button bar. Select the **Update in document** icon or right-click the graph and click **Update in document** to refresh the graph based on a different subset of the data.

<img height = "550" alt="Image" src="https://github.com/user-attachments/assets/9907fa9b-90e3-4783-ad50-a417a8d12674" />

21.	The detailed table below the bar chart can also be inserted into Excel. First, select a cell in column A of the worksheet below the graph. This will determine where the next object will be inserted. Then right-click the table in the SAS pane and select **Insert in document**.

<img height = "550"  alt="Image" src="https://github.com/user-attachments/assets/4b260e94-ed66-4341-94a9-163e13d76ac4" />

<img height = "550"  alt="Image" src="https://github.com/user-attachments/assets/fc64e407-ef42-4253-bcbf-3e19178d8414" />

<img height = "550" alt="Image" src="https://github.com/user-attachments/assets/f930e391-587f-4352-8661-fe2a0a298450" />

22.	The table can be further enhanced in the worksheet by using Excel features. Highlight the header row in the report, then select **Home** in the Excel ribbon. Click **Sort &** **Filter > Filter**.

<img width="1920" height="301" alt="Image" src="https://github.com/user-attachments/assets/41cef4b2-d86c-48aa-b230-0d95b7067a5f" />

23.	Use the option menu on Gross Labor Amount to select **Sort Largest to Smallest**.

<img  height="550" alt="Image" src="https://github.com/user-attachments/assets/605902a4-94c5-4d72-8a0c-f9b59da978c9" />

24.	Next, select the data values under Gross Labor Amount and select **Conditional Formatting > Data Bars** and click the orange gradient fill option.
**Note:** Depending on the Excel modifications made in the worksheet, the changes may or may not persist after updating report objects.  

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/22e93d46-1e7d-41d1-91ec-7a8c7a8dab3d" />

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/515b5b70-9dcc-4234-9fc5-edeaed133566" />

25.	Hover over the bar chart in the SAS pane and click **Restore** to return to the full report view.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/b771a337-c708-4bf5-b0e4-b730a69e0694" />

26.	We have added two report objects, but you can also add all objects from a page. Select the **Labor Details** page to view the three visualizations. Then right-click anywhere on the page and select **Insert active page in document**. A new worksheet is created named Labor Details, which includes the three charts.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/d1f8dbc0-18c0-4a58-b53f-59815989fe1f" />

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/a8bd6c69-2585-4d89-beba-2e3eb69317a0" />

------------------------------------------------------------------------

# Excel: Insert Data
27.	Next, select the **Data** tab in the SAS pane. You can view tables defined in your SAS Viya environment and insert data into Excel for local exploration and processing. Select **All tables > SAS Studio compute context server**, then select the **SASHELP** library and the **HOMEEQUITY** table.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/5b90167c-0625-44c8-9476-755f6858ce58" />

28. A new **Results** tab is now active, providing an opportunity to subset the data and select table options prior to inserting it into the Excel worksheet.

29.	In the **General** tab, change Insert rows to **All rows**.  

<img width="267" height="240" alt="Image" src="https://github.com/user-attachments/assets/da92f3a7-ef9d-4a9b-9201-a1118c6dabc4" />

30.	In the **Columns** tab, clear the check boxes for the following columns: **YOJ**, **DEROG**, **DELINQ**, **CLAGE**, **NINQ**, and **CLNO**.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/85855e29-215f-4882-9af9-966cfab246ef" />

31.	In the **Filter** tab, you can either build an expression graphically, or code the filter expression from scratch. Click **Graphical builder** and confirm the selected variable is **BAD**. Click **Filter** then type **1** in the Value field. When BAD=1, it indicates the loan defaulted. Note that you can also use the Lookup Value button to select values from the input data. Click **OK**.  

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/003bcfef-6d0f-4fc2-8bbd-82d4d0791eed" /> <br>

<img width="612" height="191" alt="Image" src="https://github.com/user-attachments/assets/4eea69ec-4280-4991-8e5e-086a72947253" /> <br>

<img width="620" height="516" alt="Image" src="https://github.com/user-attachments/assets/fd541567-8fba-4e3e-b48d-00cafb84fdd3" />

4.	From the **Sort** tab, click **Add sort** and change the column to **LOAN**.

<img width="607" height="162" alt="Image" src="https://github.com/user-attachments/assets/dafc432b-739c-4bf0-a850-2c129436cd05" />

20.	Create a new worksheet in the Excel file and rename it **HOMEEQUITY Data**. Click the first cell in the upper left corner, then in the SAS pane click **Insert table in document.** The selected data is added to the spreadsheet. You can take advantage of Excel functionality to enhance the view with filtering, sorting, and formatting.  (Encourage people to play with Excel features??)

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/8b0a83f6-d267-4d56-86bd-006ab17ca87c" />

21.	Not only can you view SAS data in Excel, but there is also an option in the SAS Viya tab in the ribbon to upload data. This provides the opportunity to prepare data in Excel, then load it to SAS Viya for further analysis in applications like SAS Studio, Visual Analytics, or Model Studio. **do this if time**

<img width="613" height="143" alt="Image" src="https://github.com/user-attachments/assets/5fc73447-f4ca-46ce-b8f7-5cfb3bfe1544" />

------------------------------------------------------------------------

# Excel: Insert Program Results

22.	Examine the **HOMEEQUITY** data more closely. Notice the column **City** is in lower case. This can be resolved temporarily in Excel, or you can use SAS code to create a new table with the proper case values. Select **Programs** and enter the following program in the **Code** tab. Notice as you type, autocomplete prompts provide suggestions for valid keywords and tables.

``` sas
data work.homeequity_update;
   set sashelp.homeequity;
   City=propcase(City);
run;
```

This DATA step will capitalize the first letter of each word in **City**.

24.	Additional SAS syntax may be used to summarize or analyze data. Add the following PROC FREQ step to generate frequency counts for the HOMEEQUITY_UPDATE table.

``` sas
proc freq data=work.homeequity_update  order=freq;
 tables State / nocum;
run;
```

25.	Click **Run**. The **Results** tab includes the frequency report. Create a new worksheet and select the upper left cell. Click **Insert in document** to add the results.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/24417db0-7f48-44f4-b537-511f7d79a320" /> <br>

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/d33140bb-05a1-4b2c-bb46-73545cd417e7" />

27.	What if the program is modified? Return to the **Code** tab and add a **TITLE** statement above the PROC FREQ step to provide a custom title and an **ODS NOPROCTITLE** statement to hide the procedure name. Click **Run**.

``` sas
	title "Number of Loans by State"; 
	ods noproctitle;
```
<img height="550" alt="Image" src="https://github.com/user-attachments/assets/e9bcf691-f841-4e00-bdf9-cceb5c838914" />

32.	In the SAS panel, click **Update in document** to refresh the results in the worksheet.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/a48fce1d-ea01-4b6a-97dc-b770e68be0de" /> <br>

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/530b3860-62c1-44a1-9434-53e908fa4446" />

33.	Click **Output Data** to view the new table created by the program. Scroll to the right to confirm the **City** column is in proper case. Click **Open** to access the **Results** tab. Here you have the option to filter and sort the data and insert the results into the Excel workbook.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/7aebead9-9eed-4561-9d44-d19cc6ae31e9" /> <br>

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/a1957b32-75bb-4b25-8b2b-256b383b5780" />

35.	Return to the **Programs** tab. There is a note indicating that the program is embedded in the document. This means that if the Excel workbook is saved, closed, and reopened, it will contain active links to your SAS content, as well as any embedded SAS programs. To save the program outside of the Excel file so that it is accessible in other applications or to your colleagues, click **More options** and select **Save**. You can name the file and choose a storage location in SAS Content. Click **Cancel**.

<img width="671" height="227" alt="Image" src="https://github.com/user-attachments/assets/d06d43b5-7e3f-4231-9614-95f98580eb7e" /> <br>

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/495443a0-926b-4a38-8169-e369e3ab94ee" /> <br>

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/503ec9db-57d8-4a97-a0ef-cd1b3d745256" />

36.	Click **More options** and notice there is also the ability to open a program, allowing you to access and execute code from an external file.

<img height="550" alt="Image" src="https://github.com/user-attachments/assets/07c235f5-fbaf-4ce3-bc49-b9003a65160d" />

Show inserting SAS Viya job objects, text adam and lynne about file for cars selection

------------------------------------------------------------------------

# PowerPoint

**NOTE:** Outlook is not configured in the SAS Virtual Lab to complete this portion of the demonstration, so please watch the instructor's screen instead.

**Demo notes for me, not students (take out of HOW instructions on github)**
30.	Open Outlook to see some of the unique features available when sharing SAS content via email. Create a new email message, then click SAS Home to access the SAS pane.

31.	In the Home tab, change the drop-down list to Favorites and double-click the Warranty Analysis report. You may also select Reports to access any reports in SAS Content.

32.	In the Cost Overview report page, maximize the Bar Chart object. Click   (Object menu) for both the bar chart and the table to select Insert in message. Note that the menu also allows you to attach individual report objects as a PDF.

33.	Select   (More options) in the upper-right corner of the Results tab, then select Attach report as a PDF. There are many choices available to customize the document.

34.	In the Options tab, verify the following options are selected:

o	Show page numbers
o	Include Table of Contents
o	Include cover page

35.	In the Select Objects tab, clear the check boxes for Detailed Cost Analysis and Labor Group Analysis and Forecast. Click OK. Open the attached PDF to view the result.  

36.	Finally, you can add a link to the live report in SAS Visual Analytics. In the email message, type Link to full report:. Then click   (Insert report link in message). Additional text or information can be added before sending the email message.

## PowerPoint and Word: Insert Report Content

You can also insert report objects into Microsoft Word documents and PowerPoint slides. The features in both applications are similar, so we will demonstrate in PowerPoint. **Show word as well, take from course, time everything
**
37.	Open PowerPoint and create a new blank slide deck. Right-click the title slide and select **Layout > Title Only**. Type _Cost Overview_ in the Title box.

38.	From the SAS Viya tab in the ribbon, select **Home** and log in. In the **Home** tab in the SAS pane, select **Favorites > Warranty Analysis**. Expand the SAS pane to enlarge the view of the report.

39.	In the **Cost Overvie**w page, find the Bar Chart object and select **Object menu**, then click Insert in **document**. Notice that the bar labels are staggered in the graph because there isn't enough space to display them on the same line. Resize the graph to fill the slide, then click **Object menu** and select **Update in document** to regenerate the bar chart in the allocated space.

40.	Create a new slide and change the layout to **Blank**. Insert the **Cost Change from Previous Year by Primary Labor Group** bubble plot. Again, resize the image to fill the slide, then click **Update all objects in document**. You may use all PowerPoint functionality to create beautiful, insightful presentations, with embedded, live results from your SAS reports.

# Word

We've toured several of the applications that are supported with SAS for Microsoft 365. To learn more, click Help in the SAS Viya ribbon to access complete documentation.  

